<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è€å…µç»´ä¿®é“º - ç®¡ç†åå°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            min-height: 100vh;
            padding: 20px;
        }

        /* ç™»å½•é¡µé¢ */
        .login-container {
            max-width: 400px;
            margin: 100px auto;
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            border: 3px solid #8b0000;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h1 {
            font-size: 28px;
            color: #1a472a;
            margin-bottom: 10px;
        }

        .login-header p {
            font-size: 16px;
            color: #666;
        }

        .login-form {
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-size: 16px;
            color: #333;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            font-weight: bold;
            color: #ffd700;
            background: linear-gradient(135deg, #1a472a 0%, #2d5016 100%);
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .login-btn:hover {
            opacity: 0.9;
        }

        .error-message {
            color: #dc3545;
            font-size: 14px;
            margin-top: 10px;
            text-align: center;
            display: none;
        }

        /* ç®¡ç†åå° */
        .dashboard {
            display: none;
            max-width: 1200px;
            margin: 0 auto;
        }

        .dashboard-header {
            background: linear-gradient(135deg, #1a472a 0%, #2d5016 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 3px solid #8b0000;
        }

        .dashboard-header h1 {
            font-size: 28px;
            color: #ffd700;
        }

        .logout-btn {
            padding: 10px 20px;
            font-size: 16px;
            color: #1a472a;
            background: #ffd700;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 12px;
            border: 3px solid #1a472a;
            text-align: center;
        }

        .stat-number {
            font-size: 48px;
            font-weight: bold;
            color: #1a472a;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 18px;
            color: #666;
        }

        /* ç”³è¯·åˆ—è¡¨ */
        .requests-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            border: 3px solid #8b0000;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #1a472a;
        }

        .section-header h2 {
            font-size: 24px;
            color: #1a472a;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
        }

        .filter-btn {
            padding: 8px 16px;
            font-size: 14px;
            border: 2px solid #1a472a;
            background: white;
            color: #1a472a;
            border-radius: 6px;
            cursor: pointer;
        }

        .filter-btn.active {
            background: #1a472a;
            color: #ffd700;
        }

        .request-item {
            background: #f8f9fa;
            border-left: 5px solid #1a472a;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
            position: relative;
        }

        .request-item.completed {
            opacity: 0.6;
            border-left-color: #28a745;
        }

        .request-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .request-info {
            flex: 1;
        }

        .request-name {
            font-size: 20px;
            font-weight: bold;
            color: #1a472a;
            margin-bottom: 5px;
        }

        .request-phone {
            font-size: 18px;
            color: #8b0000;
            margin-bottom: 10px;
        }

        .request-detail {
            font-size: 16px;
            color: #333;
            margin-bottom: 5px;
        }

        .request-detail strong {
            color: #1a472a;
        }

        .request-time {
            font-size: 14px;
            color: #999;
            margin-top: 10px;
        }

        .request-actions {
            display: flex;
            gap: 10px;
            flex-direction: column;
        }

        .action-btn {
            padding: 8px 16px;
            font-size: 14px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }

        .complete-btn {
            background: #28a745;
            color: white;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state h3 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        /* æ¸…ç©ºæ•°æ®æŒ‰é’® */
        .danger-zone {
            background: #fff3cd;
            border: 3px solid #ffc107;
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
        }

        .danger-zone h3 {
            color: #856404;
            margin-bottom: 15px;
        }

        .clear-btn {
            padding: 10px 20px;
            font-size: 16px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .dashboard-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .filter-buttons {
                flex-direction: column;
            }

            .request-header {
                flex-direction: column;
            }

            .request-actions {
                width: 100%;
                margin-top: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- ç™»å½•é¡µé¢ -->
    <div class="login-container" id="loginContainer">
        <div class="login-header">
            <h1>ğŸ–ï¸ ç®¡ç†åå°</h1>
            <p>è€å…µç»´ä¿®é“º Â· ç»´ä¿®ç”³è¯·ç®¡ç†</p>
        </div>
        <form class="login-form" id="loginForm">
            <div class="form-group">
                <label for="password">è¯·è¾“å…¥å¯†ç </label>
                <input type="password" id="password" placeholder="è¾“å…¥ç®¡ç†å¯†ç " required>
            </div>
            <button type="submit" class="login-btn">ç™»å½•</button>
            <div class="error-message" id="errorMessage">å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•</div>
        </form>
        <div style="margin-top: 20px; padding: 15px; background: #e7f3ff; border-radius: 8px; font-size: 14px; color: #004085;">
            <strong>ğŸ’¡ æç¤ºï¼š</strong>é»˜è®¤å¯†ç æ˜¯ <code style="background: white; padding: 2px 8px; border-radius: 4px;">laobingweixiu</code>
        </div>
    </div>

    <!-- ç®¡ç†åå° -->
    <div class="dashboard" id="dashboard">
        <div class="dashboard-header">
            <h1>ğŸ–ï¸ è€å…µç»´ä¿®é“º Â· ç®¡ç†åå°</h1>
            <button class="logout-btn" onclick="logout()">é€€å‡ºç™»å½•</button>
        </div>

        <!-- ç»Ÿè®¡å¡ç‰‡ -->
        <div class="stats-cards">
            <div class="stat-card">
                <div class="stat-number" id="statTotal">0</div>
                <div class="stat-label">ç´¯è®¡ç»´ä¿®</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statPeople">0</div>
                <div class="stat-label">æœåŠ¡äººæ¬¡</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statPending">0</div>
                <div class="stat-label">å¾…å¤„ç†</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="statCompleted">0</div>
                <div class="stat-label">å·²å®Œæˆ</div>
            </div>
        </div>

        <!-- ç”³è¯·åˆ—è¡¨ -->
        <div class="requests-section">
            <div class="section-header">
                <h2>ğŸ“‹ ç»´ä¿®ç”³è¯·åˆ—è¡¨</h2>
                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterRequests('all')">å…¨éƒ¨</button>
                    <button class="filter-btn" onclick="filterRequests('pending')">å¾…å¤„ç†</button>
                    <button class="filter-btn" onclick="filterRequests('completed')">å·²å®Œæˆ</button>
                </div>
            </div>
            <div id="requestsList">
                <!-- åŠ¨æ€åŠ è½½ç”³è¯·åˆ—è¡¨ -->
            </div>
        </div>

        <!-- å±é™©åŒºåŸŸ -->
        <div class="danger-zone">
            <h3>âš ï¸ å±é™©æ“ä½œ</h3>
            <p style="color: #856404; margin-bottom: 15px;">æ¸…ç©ºæ‰€æœ‰æ•°æ®å°†æ— æ³•æ¢å¤ï¼Œè¯·è°¨æ…æ“ä½œï¼</p>
            <button class="clear-btn" onclick="clearAllData()">æ¸…ç©ºæ‰€æœ‰æ•°æ®</button>
        </div>
    </div>

    <script>
        // é…ç½®
        const ADMIN_PASSWORD = 'laobingweixiu'; // ç®¡ç†å¯†ç ï¼Œå¯ä»¥ä¿®æ”¹
        const STORAGE_KEY = 'veteran_repair_stats';

        // ç™»å½•åŠŸèƒ½
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const password = document.getElementById('password').value;
            
            if (password === ADMIN_PASSWORD) {
                sessionStorage.setItem('admin_logged_in', 'true');
                showDashboard();
            } else {
                document.getElementById('errorMessage').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('errorMessage').style.display = 'none';
                }, 3000);
            }
        });

        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        function checkLogin() {
            if (sessionStorage.getItem('admin_logged_in') === 'true') {
                showDashboard();
            }
        }

        // æ˜¾ç¤ºç®¡ç†åå°
        function showDashboard() {
            document.getElementById('loginContainer').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            loadData();
        }

        // é€€å‡ºç™»å½•
        function logout() {
            sessionStorage.removeItem('admin_logged_in');
            document.getElementById('loginContainer').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('password').value = '';
        }

        // è·å–æ•°æ®
        function getStats() {
            const stats = localStorage.getItem(STORAGE_KEY);
            if (stats) {
                return JSON.parse(stats);
            }
            return {
                total: 28,
                peopleServed: 12,
                records: []
            };
        }

        // ä¿å­˜æ•°æ®
        function saveStats(stats) {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(stats));
        }

        // åŠ è½½æ•°æ®
        function loadData() {
            const stats = getStats();
            
            // è®¡ç®—å¾…å¤„ç†å’Œå·²å®Œæˆæ•°é‡
            const pending = stats.records.filter(r => !r.completed).length;
            const completed = stats.records.filter(r => r.completed).length;

            // æ›´æ–°ç»Ÿè®¡å¡ç‰‡
            document.getElementById('statTotal').textContent = stats.total;
            document.getElementById('statPeople').textContent = stats.peopleServed || stats.total;
            document.getElementById('statPending').textContent = pending;
            document.getElementById('statCompleted').textContent = completed;

            // æ¸²æŸ“ç”³è¯·åˆ—è¡¨
            renderRequests();
        }

        // ç­›é€‰çŠ¶æ€
        let currentFilter = 'all';

        // ç­›é€‰ç”³è¯·
        function filterRequests(filter) {
            currentFilter = filter;
            
            // æ›´æ–°æŒ‰é’®çŠ¶æ€
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            renderRequests();
        }

        // æ¸²æŸ“ç”³è¯·åˆ—è¡¨
        function renderRequests() {
            const stats = getStats();
            const container = document.getElementById('requestsList');
            
            let records = stats.records;
            
            // æ ¹æ®ç­›é€‰æ¡ä»¶è¿‡æ»¤
            if (currentFilter === 'pending') {
                records = records.filter(r => !r.completed);
            } else if (currentFilter === 'completed') {
                records = records.filter(r => r.completed);
            }

            // æŒ‰æ—¶é—´å€’åºæ’åˆ—
            records.sort((a, b) => new Date(b.date) - new Date(a.date));

            if (records.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <h3>ğŸ“­ æš‚æ— ç”³è¯·è®°å½•</h3>
                        <p>ç­‰å¾…é‚»å±…æäº¤ç»´ä¿®ç”³è¯·...</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = records.map((record, index) => `
                <div class="request-item ${record.completed ? 'completed' : ''}" data-index="${index}">
                    <div class="request-header">
                        <div class="request-info">
                            <div class="request-name">${record.name}</div>
                            <div class="request-phone">ğŸ“ ${record.phone}</div>
                            <div class="request-detail"><strong>ç”µå™¨ï¼š</strong>${record.appliance}</div>
                            <div class="request-detail"><strong>é—®é¢˜ï¼š</strong>${record.problem}</div>
                            <div class="request-time">â° æäº¤æ—¶é—´ï¼š${formatDate(record.date)}</div>
                            ${record.completed ? '<div class="request-time" style="color: #28a745;">âœ… å·²å®Œæˆ</div>' : ''}
                        </div>
                        <div class="request-actions">
                            ${!record.completed ? `
                                <button class="action-btn complete-btn" onclick="completeRequest(${index})">
                                    âœ“ æ ‡è®°å®Œæˆ
                                </button>
                            ` : ''}
                            <button class="action-btn delete-btn" onclick="deleteRequest(${index})">
                                ğŸ—‘ï¸ åˆ é™¤
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // æ ‡è®°ä¸ºå·²å®Œæˆ
        function completeRequest(index) {
            const stats = getStats();
            stats.records[index].completed = true;
            saveStats(stats);
            loadData();
        }

        // åˆ é™¤ç”³è¯·
        function deleteRequest(index) {
            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡ç”³è¯·è®°å½•å—ï¼Ÿ')) {
                return;
            }
            
            const stats = getStats();
            stats.records.splice(index, 1);
            stats.total--;
            stats.peopleServed = (stats.peopleServed || stats.total + 1) - 1;
            
            saveStats(stats);
            loadData();
        }

        // æ¸…ç©ºæ‰€æœ‰æ•°æ®
        function clearAllData() {
            if (!confirm('âš ï¸ ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿ\n\nè¿™å°†åˆ é™¤æ‰€æœ‰ç»´ä¿®ç”³è¯·è®°å½•å’Œç»Ÿè®¡æ•°æ®ï¼Œæ­¤æ“ä½œæ— æ³•æ¢å¤ï¼')) {
                return;
            }
            
            if (!confirm('âš ï¸ å†æ¬¡ç¡®è®¤ï¼šçœŸçš„è¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿ')) {
                return;
            }
            
            localStorage.removeItem(STORAGE_KEY);
            alert('âœ… æ•°æ®å·²æ¸…ç©ºï¼');
            loadData();
        }

        // æ ¼å¼åŒ–æ—¥æœŸ
        function formatDate(dateString) {
            const date = new Date(dateString);
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            
            return `${year}-${month}-${day} ${hours}:${minutes}`;
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ç™»å½•çŠ¶æ€
        checkLogin();
    </script>
</body>
</html>
